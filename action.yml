name: "Run Noxtara Scan"
description: "Run SCA/SAST security scans using @noxtara/cli"
author: "xcidic"
branding:
  icon: "shield"
  color: "blue"

inputs:
  api-key:
    description: "Noxtara API key for authentication"
    required: true
  api-url:
    description: "Noxtara API URL"
    required: false
    default: "https://app.noxtara.com/api/main/client"
  working-directory:
    description: "Directory to scan (relative to repository root)"
    required: false
    default: "."
  cli-version:
    description: "Version of @noxtara/cli to use"
    required: false
    default: "latest"

runs:
  using: "composite"
  steps:
    - name: Setup Node.js
      uses: actions/setup-node@v6
      with:
        node-version: "24"

    - name: Install Noxtara CLI
      shell: bash
      run: npm install -g @noxtara/cli@${{ inputs.cli-version }}

    - name: Run Noxtara Scan
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      run: noxtara scan
      env:
        NOXTARA_API_KEY: ${{ inputs.api-key }}
        NOXTARA_API_URL: ${{ inputs.api-url }}
